---
title: "Proteomic and bioinformatics analyses of plasma from SCI neurological improvers and non-improvers"
#subtitle: "ISCoS 2021: VIRTUAL"
author: "Gabriel Mateus Bernardo Harrington"
institute: "Keele University"
date: "ISCoS 2021: VIRTUAL<br>Presented: 2021-10-01<br>(updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    includes:
      after_body: insert-logo.html
    lib_dir: libs
    stand_alone: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
csl: /home/mateus/Documents/citation_styles/elsevier-vancouver.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE,
                      fig.showtext = TRUE, fig.retina = 3, warning = FALSE)
options(knitr.kable.NA = '') #sets NAs in tables to be blank
library(xaringanthemer)
library(tidyverse)
library(kableExtra)
library(ggVennDiagram)
library(MSstats)
library(RefManageR)
library(leaflet)
```

```{r, load_refs, include=FALSE, cache=FALSE}
## set citation styles
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = "to.doc",
           dashed = FALSE)
## read bib file. trying to read masterlib causes R to crash, maybe file size or non-standard charaters
bib <- ReadBib("iscos_talk_2021.bib", check = FALSE)
```

```{r xaringan-themer, include=FALSE}
## set theme details via xaringanthemer - this generates the xaringan-themer.css file
style_duo(primary_color = "#1F4257", secondary_color = "#F97B64",
          ## lower header font sizes by 0.5rem
          header_h1_font_size = "2.25rem", header_h2_font_size = "1.75rem",
          header_h3_font_size = "1.25rem",
          ## set srtiped row colour for tables
          table_row_even_background_color = "#F97B64")
```


## Speaker declaration

I declare to have no interests in the below:

- The existence of any significant financial activity or other relationship
- Financial or material compensation in relation to research and publishing
- Financial or material compensation in relation to educational activities
- Ownerships and possessions in companies related to health care (includes service provides, IT)
- Compensation for expert functions in health care and consulting health care guidance processes

.center[
```{r, label='oswestry-leaflet', fig.height=4, fig.width=10.5 }
leaflet() %>% addTiles() %>% setView(-3.033414, 52.884422, zoom = 16)
```
]

???

- What an odd compulsory speil...

---

## Prior work

- Modelling of neurological outcomes with routine heamatological markers`r AutoCite(bib, c("brown_preliminary_2019", "bernardo_harrington_routinely_2020"))`
- Found markers associated with liver function added modest predictive value
- Implicates metabolic health with outcomes

.center[
```{r rsquare-plot, out.width="50%"}
df_models <- read_rds('heam_model_data.rds')

rsquare_plot <- ggplot(df_models, aes(x = target_name, y = Rsquare, fill = modelName)) +
    geom_bar(stat="identity", position=position_dodge(), color = "black") +
    xlab("") +
    ylab(parse(text = "R^2")) +
    scale_y_continuous(limits = c(0,1)) +
    ## theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5)) +
    theme(legend.position = "bottom", axis.text = element_text(size = 12)) +
    scale_x_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
                                                   width = 18)) +
    coord_flip() +
    theme_xaringan() +
    scale_xaringan_fill_discrete(label = c("GLM", "LRM"), name = "Model")

rsquare_plot
```
]

---

## Experimental design

- Plasma from SCI human patients
- Two time points:
  1. "Acute": ~2-weeks post-injury
  1. "Subacute": ~3-months post-injury<sup>*</sup>
- Improvers are AIS C patients who experienced an AIS grade conversion
- 2 4-plex iTRAQ runs and a more recent label-free experiment with all samples

```{r, label='sample-counts'}
sample_counts <- read_csv("sample_counts_2021-04-30.csv")
kbl(sample_counts) %>%
    kable_styling(bootstrap_options = c("hover"))
```

.footnote[<sup>*</sup> iTRAQ experiments did not include AIS A or D groups at the subacute time point]

---

## "Bottom-up" Proteomics - A brief overview

1. Extract consistent total protein concentration for each sample
1. Optional dimensionality reduction steps (e.g. via Proteominer&trade; beads)
1. Digest proteins (Trypsin is commonly used)
1. For labelled techniques, the labels are applied
1. Samples are fed through some flavour of chromatography and into the mass spec (e.g. high-performance liquid chromatography)

--

### Techniques used:

- Isobaric tag for relative and absolute quantitation ([iTRAQ](https://en.wikipedia.org/wiki/Isobaric_tag_for_relative_and_absolute_quantitation)) and [label-free](https://en.wikipedia.org/wiki/Label-free_quantification) proteomic experiments were conducted

.center[
```{r, label='itraq-tag', out.width="40%"}
knitr::include_graphics("../proteomic_talk_2020-09-24/itraq_labels.png")
```
]

???

- Highlight complexity and uncertainty in measurements - put data in context, further work needed etc.

---

## iTRAQ proteins of interest

### Alpha-2-macroglobulin

.pull-left[
```{r, label='itraq-openms-data'}
## openms data
foldchange_list <- readRDS("../../mateus/proteomics/data/openms/protein_quantification_foldchanges.rds")
## merge list of dfs
fc_openms <- do.call(rbind, foldchange_list)
## add run column
fc_openms <- fc_openms %>%
    rownames_to_column() %>%
    dplyr::mutate(run = case_when(
                      grepl("run1", rowname) ~ "1",
                      TRUE ~ "2")) %>%
    dplyr::mutate(piv_wide = paste(comparison, run, sep = "_run"))
## sort group labels
fc_openms$piv_wide <- as.factor(fc_openms$piv_wide)
levels(fc_openms$piv_wide) <- c("Acute AIS A vs D",
                                "Acute AIS C improvers vs A",
                                "Acute AIS C improvers vs non-improvers",
                                "Acute AIS C improvers vs non-improvers (2)",
                                "AIS C improvers acute vs subacute",
                                "Acute AIS C improvers vs D",
                                "Acute AIS C non-improvers vs A",
                                "AIS C non-improvers acute vs subacute",
                                "Acute AIS C non-improvers vs D", "CROSS-RUN",
                                "Subacute AIS C improvers vs non-improvers",
                                "CROSS-RUN2", "CROSS-RUN3", "CROSS-RUN4")
## vector of proteins to filter to
proteins <- c("A2M|APOE|RBP4|SAA1")
## filter df
df_filt <- fc_openms %>%
    dplyr::filter(grepl(proteins, gene) & !grepl("CROSS", piv_wide))
## plot
df_filt %>%
    dplyr::filter(gene == "A2M") %>%
    ggplot(aes(x = reorder(piv_wide, -log2_fold_change), y = log2_fold_change, fill = piv_wide)) +
    geom_bar(stat="identity", position = position_dodge()) +
    facet_wrap( ~ gene) +
    labs(x = "", y = expression(log[2] ~ fold - change)) +
    theme(legend.position = "none", axis.text = element_text(size = 12)) +
    scale_x_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
                                                   width = 18)) +
    coord_flip() +
    theme_xaringan() +
    scale_xaringan_fill_discrete()
```
]

.pull-right[
- [Alpha-2-macroglobulin](https://www.unigene.org/uniprot/P01023)
  - Inhibitor of virtually any protease
  - A2M-protease complex cleared mainly by hepatocytes `r AutoCite(bib, "bond_incorporation_2007")`
  - Less A2M -> more protease activity -> enhanced clearance of damaged tissue?
  - Attenuation of glial scar formation?
]

???

- FCs between -1 and 1 are suspect
- Downreg in acute and subacute C imp vs non-imp (~ -1 & ~ -0.2 fc)
- Downreg in C groups vs A, upreg in C vs D - tracks with severity

---

## iTRAQ proteins of interest

### Apolipoproteins

.pull-left[
```{r, label='apoe-plot'}
df_filt %>%
    dplyr::filter(gene == "APOE") %>%
    ggplot(aes(x = reorder(piv_wide, -log2_fold_change), y = log2_fold_change, fill = piv_wide)) +
    geom_bar(stat="identity", position = position_dodge()) +
    facet_wrap( ~ gene) +
    labs(x = "", y = expression(log[2] ~ fold - change)) +
    theme(legend.position = "none", axis.text = element_text(size = 12)) +
    scale_x_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
                                                   width = 18)) +
    coord_flip() +
    theme_xaringan() +
    scale_xaringan_fill_discrete()
```
]

.pull-right[
- Several apolipoproteins, ApoE and ApoA1 (main component of High-Density Lipoprotein (HDL)) in particular
- ApoE mainly produced by hepatocytes, serves as ligand for Low-Density Lipoprotein receptors which mediates cholesterol traffic to neurons, **vital for axonal growth, synapse formation and remodelling** `r Cite(bib, "xu_interactions_2014")`
- The ApoE4 variant is associated with poorer outcomes in SCI, TBI and Alzheimer's Disease `r Cite(bib, "jha_apolipoprotein_2008")`
]

???

- Downreg in acute C imp vs non-imp (~ -1.25 fc)
- Upreg in subacute C imp vs non-imp (~ 0.3 fc)
- Downreg in C groups and D vs A

---

## iTRAQ proteins of interest

### Serum amyloid A1

.pull-left[
```{r, label='saa1-plot'}
df_filt %>%
    dplyr::filter(gene == "SAA1") %>%
    ggplot(aes(x = reorder(piv_wide, -log2_fold_change), y = log2_fold_change, fill = piv_wide)) +
    geom_bar(stat="identity", position = position_dodge()) +
    facet_wrap( ~ gene) +
    labs(x = "", y = expression(log[2] ~ fold - change)) +
    theme(legend.position = "none", axis.text = element_text(size = 12)) +
    scale_x_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
                                                   width = 18)) +
    coord_flip() +
    theme_xaringan() +
    scale_xaringan_fill_discrete()
```
]

.pull-right[
- [Serum amyloid A1](https://www.uniprot.org/uniprot/P0DJI8)
- Precursor of amyloid A, the aberrant deposition of which leads to inflammatory amyloidosis `r Cite(bib, "sun_serum_2016")`
- Produced by hepatocytes, during acute phase response they associate with HDL, displacing ApoA1 `r Cite(bib, "benditt_amyloid_1977")`
- SAA binding HDL is thought to favour removal of cholesterol from sites of inflammation
]

???

- Downreg in acute C imp vs non-imp (~ -2.5 fc)
- Upreg in subacute C imp vs non-imp (~ 2.4 fc)
- Downreg in C groups and D vs A

---

## iTRAQ proteins of interest

### Retinol-binding protein 4

.pull-left[
```{r, label='rbp4-plot'}
df_filt %>%
    dplyr::filter(gene == "RBP4") %>%
    ggplot(aes(x = reorder(piv_wide, -log2_fold_change), y = log2_fold_change, fill = piv_wide)) +
    geom_bar(stat="identity", position = position_dodge()) +
    facet_wrap( ~ gene) +
    labs(x = "", y = expression(log[2] ~ fold - change)) +
    theme(legend.position = "none", axis.text = element_text(size = 12)) +
    scale_x_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
                                                   width = 18)) +
    coord_flip() +
    theme_xaringan() +
    scale_xaringan_fill_discrete()
```
]

.pull-right[
- [Retinol-binding protein 4](https://www.uniprot.org/uniprot/P02753)
- Key transporter proteins for vitamin A (retinol)
- Retinoid signalling is involved in spinal cord and motor neuron differentiation `r Cite(bib, "lane_role_2005")`
- Transgenic mouse studies have implicated retinoid signalling in retained plasticity and regenerative potential of the mature spinal cord `r Cite(bib, "haskell_retinoic_2002")`
]

???

- Similar modest upreg in acute and subacute C imp vs non-imp (~ 0.42 fc), but in run 2 there's a large downreg (~ -4 fc) for the acute
- Upreg in subacute C imp vs non-imp (~ 2.4 fc)
- Downreg in acute C imp vs D and A (~ -1.7 & -3 fc), but upreg in acute C non-imp vs D and A (~ 1.2 & 2.5 fc)
---

## iTRAQ key pathway - Complement cascade

- Majority of proteins identified are part of the complement cascade, differences in these pathways appears to be at least partially responsible for heterogeneous outcomes
- Many of these proteins interact with the liver in some capacity
- Future studies modelling SCI outcomes may wish to incorporate ApoE variant as a factor

```{r, label='kegg-complement', fig.align="center"}
knitr::include_graphics("../../mateus/proteomics/figures/kegg_pathways/hsa04610_pathview.png")
```

???

The fold changes in the KEGG pathway are from the Acute AIS C improvers relative to non-improvers

---

## Label-free proteins

- Data still being analysed
- Substantial overlap in proteins identified
- Complement cascade still the most significant

- Early proteins of interest:
  - Peroxiredoxin 2, detected in Acute C improvers but not Acute C non-improvers. Involved in oxidative stress response
  - Several immunoglobulins variable and constant regions, potential link to work suggesting IVIG therapy benefiting outcomes? `r Cite(bib, "brennan_ivig_2016")`

---

#### Links to this slide deck:

The rendered slides can be found at this address:

- [https://h-mateus.github.io/presentations/iscos_sci_proteomics_2021-08-31/index.html#1](https://h-mateus.github.io/presentations/iscos_sci_proteomics_2021-08-31/index.html#1)

.center[
```{r, label='slidedeck-qr-code', out.width="15%"}
knitr::include_graphics("slides_qr-code.png")
```
]

The raw files are on GitHub [here](https://github.com/H-Mateus/presentations) under the GPL license

#### Acknowledgements

.pull-left[
- Thanks to humans: Karina Wright, Paul Cool, Charlotte Hulme & the rest of the [OsKOR team](https://oskor.netlify.app/)
- Thanks for the money: [EPSRC](https://epsrc.ukri.org/)
- Thanks to the open-source community: Yihui Xie's [xaringan](https://github.com/yihui/xaringan) in particular for these slides
]

.pull-right[
```{r, label='epscr', out.width='90%'}
knitr::include_graphics("../reproducible_research_2021-04-30/EPSRC+logo.png")
```
]

---

## References

```{r, label='print-bib', results="asis"}
PrintBibliography(bib, start = 1, end = 5)
```

---

## References cont.

```{r, label='print-bib-cont', results="asis"}
PrintBibliography(bib, start = 6, end = 11)
```
